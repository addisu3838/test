<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="format-detection" content="telephone=no">
    <title>Project Dashboard ‚Ä¢ Income ‚Ä¢ Cost ‚Ä¢ SOS</title>
    <style>
        /* === RESET & VARIABLES === */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            font-family: system-ui, -apple-system, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
        }

        :root {
            --primary: #1e2b37;
            --primary-light: #2c3e50;
            --accent: #27ae60;
            --danger: #e74c3c;
            --info: #3498db;
            --warning: #f39c12;
            --bg: #f0f5f8;
            --card-bg: #ffffff;
            --text-dark: #1e2b37;
            --text-soft: #2c3e50;
            --border-light: #e9edf2;
            --income: #27ae60;
            --cost: #e74c3c;
            --profit: #2980b9;
            --header-gradient: linear-gradient(145deg, #1a2632, #2c3e50);
            --shadow-sm: 0 2px 8px rgba(0,0,0,0.04);
            --shadow-md: 0 4px 12px rgba(0,0,0,0.08);
        }

        body {
            background: var(--bg);
            color: var(--text-dark);
            min-height: 100vh;
            display: flex;
            padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
        }

        .app-wrapper {
            width: 100%;
            max-width: 600px;
            margin: 0 auto;
            background: var(--bg);
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            border-radius: 0;
        }

        .content-container {
            flex: 1;
            overflow-y: auto;
            overflow-x: hidden;
            -webkit-overflow-scrolling: touch;
            padding: 2px 0 80px 0;
            background: white;
        }

        /* === FLOATING BOTTOM TABS (only 3) === */
        .floating-footer {
            position: fixed;
            bottom: 20px;
            left: 0;
            right: 0;
            display: flex;
            justify-content: center;
            pointer-events: none;
            z-index: 1000;
            padding: 0 8px;
        }

        .floating-tabs {            
            padding: 5px 5px;
            border-radius: 59px;
            display: flex;
            gap: 6px;
            box-shadow: 0 4px 20px rgba(159, 241, 6, 0.3);
            pointer-events: auto;
            border: 1px solid rgba(184, 248, 66, 0.2);
            backdrop-filter: blur(10px); 
            background-color: white;                      
        }

        .nav-btn {
            background: rgba(147, 243, 103, 0.15);
            border: 1px solid rgba(25, 231, 94, 0.3);
            color: #000000;
            padding: 9px 14px;
            border-radius: 150px;
            font-size: 14px;
            font-weight: 600;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 2px;
            transition: all 0.2s ease;
            cursor: pointer;
            min-width: 60px;
            justify-content: center;
        }

        .nav-btn span {
            font-size: 10px;
        }

        .nav-btn.active {
            background: #0077ff;
            border-color: rgb(17, 1, 1);
            color: rgb(3, 0, 0);
            box-shadow: 0 2px 12px #eef1f380;
            transform: scale(1.05);
        }

        .nav-btn:active {
            transform: scale(0.95);
        }

        /* === INCOME TABLE WITH HIGHLIGHTED SECTIONS === */
        .table-container {
            padding: 8px 6px;
        }

        .mobile-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 18px;
            overflow: hidden;
            box-shadow: var(--shadow-sm);
            font-size: 13px;
        }

        .mobile-table thead tr {
            background: var(--header-gradient);
        }

        .mobile-table th {
            color: white;
            font-weight: 600;
            font-size: 12px;
            padding: 16px 6px;
            text-align: left;
            letter-spacing: 0.3px;
            white-space: nowrap;
            background: #1e2b37;
        }

        .mobile-table td {
            padding: 12px 6px;
            border-bottom: 1px solid var(--border-light);
            vertical-align: middle;
            background: white;
        }

        .mobile-table tr:last-child td {
            border-bottom: none;
        }

        /* Highlight for BILL rows */
        .bill-section {
            background: linear-gradient(145deg, #fff3e0, #ffe0b2) !important;
            font-weight: 800;
            border-left: 6px solid #ff9800;
            border-right: 6px solid #ff9800;
        }
        
        .bill-section td {
            background: transparent !important;
            font-size: 15px;
            color: #e65100;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .bill-section .item-no {
            background: #ff9800;
            color: white;
            font-weight: 800;
            padding: 4px 12px;
        }
        
        .bill-section .work-description {
            font-weight: 800;
            color: #bf360c;
        }

        /* Special highlight for BILL A and BILL B */
        .bill-highlight {
            background: linear-gradient(145deg, #ffecb3, #ffe082) !important;
            border-left: 8px solid #ff6d00;
            border-right: 8px solid #ff6d00;
        }
        
        .bill-highlight td {
            background: transparent !important;
            font-size: 16px;
            color: #ff6d00;
            text-shadow: 0 1px 1px rgba(255,255,255,0.5);
        }

        .item-no {
            font-weight: 700;
            color: var(--primary-light);
            font-size: 11px;
            background: #f0f4fa;
            display: inline-block;
            padding: 3px 8px;
            border-radius: 30px;
            white-space: nowrap;
        }

        .work-description {
            font-size: 13px;
            line-height: 1.45;
            color: #1e2b37;
            max-width: 400px;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
            min-height: auto;            
        }

        .achievement-cell {
            font-weight: 500;
            color: #4a5a6a;
            text-align: right;
            font-size: 12px;
            white-space: nowrap;
        }

        .income-value {
            color: var(--income);
            font-weight: 700;
            font-size: 12px;
            text-align: right;
            white-space: nowrap;
        }

        /* === SOS DASHBOARD WITH BAR CHART === */
        .sos-dashboard {
            padding: 11px;
            background: white;
        }

        .sos-header {
            color: black;
            padding: 14px 15px;
            border-radius: 18px;
            margin-bottom: 10px;
            box-shadow: var(--shadow-md);
            background-color: #cbebd8;
            font-size: 22;
        }

        .sos-header h2 {
            font-size: 16px;
            font-weight: 400;
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 15px;
            border-radius: 18px;
        }

        .sos-table-container {
            background: white;
            border-radius: 14px;
            padding: 20px;
            box-shadow: var(--shadow-sm);
            margin-top: 15px;
        }

        .sos-data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 15px;
        }
        .sos-data-table th {
            background: #227bf0;
            color: white;
            padding: 16px 12px;
            text-align: left;
            font-weight: 600;
            font-size: 16px;
            font-weight: bold;            
        }
        .sos-data-table td {
            padding: 15px 15px;
            border-bottom: 1px solid #f0f0f0;
            font-weight: 700;
            font-style: normal;
        }
        .sos-data-table tr:last-child td {
            border-bottom: none;
        }

        .text-success {
            color: #27ae60;
            font-weight: 600;
        }

        .text-danger {
            color: #e74c3c;
            font-weight: 600;
        }

        /* === COMPARISON DASHBOARD WITH 2D COLUMN BAR CHART === */
        .comparison-dashboard {
            padding: 16px;
            background: #2b7ad3;
        }

        .comparison-header {
            background: linear-gradient(145deg, #2980b9, #3498db);
            color: white;
            padding: 24px 20px;
            border-radius: 28px;
            margin-bottom: 20px;
            box-shadow: var(--shadow-md);
        }

        .comparison-header h2 {
            font-size: 28px;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
        }

        /* 2D Column Bar Chart Styles */
        .column-chart-container {
            background:white;
            border-radius: 6px;
            padding: 6px 11px;
            margin: 12px 0 13px 0;
           /* box-shadow: var(--shadow-sm);*/
            border: 0.2px solid #fdfdfd;
            overflow-x: auto;
            max-width: auto;
        }

        .chart-title {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 20px;
            color: #2c3e50;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .column-chart {
            display: flex;
            align-items: flex-end;
            justify-content: 0;
            gap: 3px;
            min-width: 60px;
            height: 250px;
            padding: 5px 0 0 0;
            border-bottom: 2px solid #ddd;
            position: relative;
        }

        .chart-column-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
            max-width: 60px;
        }

        .column-bar {
            width: 50%;
            background: linear-gradient(180deg, #2bfce0, #d0f34f);
            border-radius: 8px 8px 0 0;
            transition: height 0.3s ease;
            position: relative;
            min-height: 4px;
            box-shadow: 0 -2px 5px rgba(0,0,0,0.1);
            border: 1px solid #3ff112;
            border-bottom: none;
        }

        .column-value {
            font-size: 11px;
            font-weight: 700;
            margin-top: 5px;
            color: #e67e22;
            background: rgba(255,255,255,0.9);
            padding: 2px 6px;
            border-radius: 20px;
            white-space: nowrap;
        }

        .column-label {
            font-size: 12px;
            font-weight: 600;
            margin-top: 8px;
            color: #2c3e50;
            text-align: center;
            word-break: break-word;
            max-width: 80px;
        }

        .y-axis-labels {
            position: absolute;
            left: -30px;
            top: 0;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            font-size: 10px;
            color: #7f8c8d;
        }

        .cost-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            border-radius: 24px;
            overflow: hidden;
            box-shadow: var(--shadow-sm);
            margin-bottom: 25px;
        }

        .cost-table th {
            background: #4244e0;
            color: white;
            padding: 16px 12px;
            text-align: left;
            font-weight: 600;
            font-size: 14px;
        }

        .cost-table td {
            padding: 14px 12px;
            border-bottom: 1px solid #f0f0f0;
            font-weight: 500;
        }

        .cost-table tr:last-child td {
            border-bottom: none;
        }

        .cost-table .total-row {
            background: #2c3e50;
            color: white;
            font-weight: 700;
        }

        .cost-table .total-row td {
            background: #2c3e50;
            color: white;
        }

        .fade-in {
            animation: fadeIn 0.25s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0.4; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @media (max-width: 480px) {
            .nav-btn {
                padding: 10px 16px;
                font-size: 14px;
                min-width: 80px;
            }
            .floating-tabs {
                gap: 6px;
                padding: 8px 12px;
            }
        }
    </style>
</head>
<body>
    <div class="app-wrapper">
        <div class="content-container" id="contentContainer"></div>

        <!-- Floating Bottom Tabs (only 3) -->
        <div class="floating-footer">
            <div class="floating-tabs">
                <button class="nav-btn active" data-tab="monthly">
                    <span>üìÖ</span> Income
                </button>
                <button class="nav-btn" data-tab="comparison">
                    <span>üìä</span> Cost
                </button>
                <button class="nav-btn" data-tab="sos">
                    <span>‚ö†Ô∏è</span> SOS
                </button>
            </div>
        </div>
    </div>

    <script>
        (function() {
            // ---------- COMPLETE PROJECT DATA (INCOME TAB - WITH HIGHLIGHTED BILL SECTIONS) ----------
            const projectData = [
                { itemNo: "BILL A", description: "GENERAL ITEMES", isBillSection: true, isHighlightBill: true },
                { itemNo: "1.12.8", description: "Allow for supplying temporary electricity, water, telephone and other utility bills for the supervisor's and contractor's including connection, distribution system for the work, internal arrangements and all payment to the authorities for connections. it is the responsibility of the contractor to ensure steady and uninterrupted power supply to work", achievement: 0.72, total: "9141575.07295305", cost: "100000" },
                { itemNo: "1.13.3", description: "Provisions of security", achievement: 0.72, total: "1425815.46702017", cost: "280000" },
                { itemNo: "1.12", description: "Allow for expenses required for conducting compensation payment estimation such as periderm for Committee, fuel cost, printing expenses and other related expenses. Payment shall be paid up on approval of the Engineer keeping all legal procedures. The costs will be reimbursed to the contractor after receiving the original invoice in the payment certificate by the Consultant", achievement: 0.12, total: "425000", cost: "350000" },
                { itemNo: "BILL B", description: "MAIN DAM", isBillSection: true, isHighlightBill: true },
                { itemNo: "2.3.1", description: "Fill and compaction the Core zone with clay material with max hauling distance of 5 Km", achievement: 36679.05, total: "10617117.813",},
                { itemNo: "", description: "production of clay material", achievement: 87021,},
                
                { itemNo: "2.4.1", description: "Fill and compaction the Shell zone with selected material, max hauling distance of 5 Km", achievement: 52913.7, total: "13807300.878",},
                { itemNo: "", description: "production of selected material", achievement: 79380,},
                
                { itemNo: "2.5.1", description: "Filter material (Finer) supply and fill(zone 2A)", achievement: 8299.13, total: "10231167.464",},
                { itemNo: "2.5.2", description: "Filter material (coarser) supply and fill(zone 2B)", achievement: 3916, total: "4836455.8",},
                { itemNo: "2.5.4", description: "Riprap(zone 5)", achievement: 2975.94, total: "2415243.14", cost: "14400" },
                { itemNo: "2.6.1", description: "Fill and compaction zone 4 with Rock material", achievement: 52477.76, total: "44596650.00",},
                { itemNo: "", description: "production of rock", achievement:  58899.80, total: "", },
                { itemNo: "2.9.4", description: "Vibrating Wire Piezometer with its complete accessories in embankment", achievement: 3, total: "561600", },
                { itemNo: "2.9.5", description: "Vibrating Wire settlement sensor with complete accessories", achievement: 2, total: "117000", },
                { itemNo: "2.9.8", description: "Vibrating wire cable", achievement: 307.94, total: "288231.84",},                
                { itemNo: "BILL C", description: "GROUTING AND FAULT TREATMENT", isBillSection: true },
                { itemNo: "3.A.1", description: "Mobilization and Demoblization", achievement: 0.5, total: "292789.65", },                
                { itemNo: "BILL D", description: "INTAKE TOWER STRUCTURE", isBillSection: true },
                { itemNo: "4.2.4", description: "Base slab", achievement: 3.17, total: "16324.64064",  },
                { itemNo: "BILL E", description: "ACCESS BRIDGE TO INTAKE TOWER", isBillSection: true },  
                { itemNo: "5.2.4", description: " Safety Hand Rail constructed out of 50mm diameter GS Pipe with 1m height and horizontally braced at top and middle of its height for access bridge, stair and operation slab as shown on the drawing", achievement: 24, total: "35236.08", cost: "3600" },
                { itemNo: "BILL H", description: "EMERGENY/ESCAPE CANAL/ STRUCTURE", isBillSection: true },
                { itemNo: "8.5.1", description: "C-25 concrete work including formwork", achievement: 8.5, total: "45602.5", },
                { itemNo: "8.5.3", description: "Reinforcement bars (bending, cutting & placing)", achievement: 48677.76, total: "19046.358", },
                { itemNo: "", description: "Dich Construction",},
                { itemNo: "11.7.1", description: "Ordinary soil excavation", achievement: 156.6, total: "12935.16", cost: "3600" },
                { itemNo: "11.7.2", description: "Basaltic or equivalent stone masonry work in cement sand mortar of 1:3 mix ratio", achievement: 404.811, total: "932097.56805", cost: "3600" },
                { itemNo: "11.7.3", description: "C-25 concrete mixing, placing, vibrating and curing for slab including formwork", achievement: 32.8, total: "194254.72", cost: "3600" },
                { itemNo: "11.7.4", description: "Reinforcement bars of √∏10mm as specified on the drawings with 150mm spacing", achievement: 156.6, total: "103830.33", cost: "3600" },
                { itemNo: "New", description: "Reinforcement bar of Dia 12mm as specified on the drawing with 200mm spacing", achievement: 3663.2, total: "250343.088", cost: "3600" },
                { itemNo: "11.7.6", description: "Cart away excavated material", achievement: 96, total: "4304.64", cost: "3600" },
                { itemNo: "11.7.8", description: "Back fill with shell material around the ditch", achievement: 480, total: "4304.64", cost: "3600" }
            ];

            // ---------- SOS DATA (WITH HORIZONTAL BAR CHART) ----------
            const sosData = [
                {
                    period: "July-1-Feb-15",                    
                    executed: 100160343.81029,
                    cost: 229221250.779779,
                },
                {
                    period: "July-1-Feb-15",                   
                    executed: 367814911.473582,
                    cost: 229221250.779779,
                }
            ];

            // ---------- COMPARISON DATA (COST DATA - USED QUANTITY ONLY) ----------
            const comparisonCostData = {
                labour: {
                    used: 3697032.51,
                },
                admin: 11475708.95,
                staff: 8985423.57,
                material: {
                    used: 50677145.73
                },
                machinery: {
                    used: 106145579.511651
                },
                overhead: 22559885.15,
                totalUsed: 229198993.73,
            };

            // ---------- Helper Functions ----------
            function formatCurrency(val) {
                if (val === '' || val === undefined || val === null) return "‚Äî";
                let num = parseFloat(val);
                if (isNaN(num)) return val.toString();
                return num.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ',');
            }

            function formatCompactCurrency(val) {
                if (val === '' || val === undefined || val === null) return "‚Äî";
                let num = parseFloat(val);
                if (isNaN(num)) return val.toString();
                
                if (num >= 1e9) {
                    return (num / 1e9).toFixed(1) + 'B';
                } else if (num >= 1e6) {
                    return (num / 1e6).toFixed(1) + 'M';
                } else if (num >= 1e3) {
                    return (num / 1e3).toFixed(1) + 'K';
                }
                return num.toFixed(0);
            }

            function formatAchievement(val) {
                if (val === '' || val === undefined) return "‚Äî";
                let n = parseFloat(val);
                if (isNaN(n)) return val.toString();
                if (n % 1 === 0) return n.toString();
                return n.toFixed(2);
            }

            // ---------- INCOME TAB WITH HIGHLIGHTED BILL SECTIONS ----------
            function loadMonthlyTable() {
                const container = document.getElementById('contentContainer');
                
                let tableRows = '';
                projectData.forEach(item => {
                    let rowClass = '';
                    if (item.isBillSection) {
                        rowClass = item.isHighlightBill ? 'bill-highlight' : 'bill-section';
                    }
                    
                    const incomeNum = parseFloat(String(item.total).replace(/,/g, '')) || 0;
                    
                    tableRows += `
                        <tr class="${rowClass}">
                            <td><span class="item-no">${item.itemNo || '‚Äî'}</span></td>
                            <td><div class="work-description" title="${item.description.replace(/"/g, '&quot;')}">${item.description}</div></td>
                            <td><div class="achievement-cell">${item.achievement ? formatAchievement(item.achievement) : '‚Äî'}</div></td>
                            <td><div class="income-value">${item.total ? formatCurrency(incomeNum) : '‚Äî'}</div></td>
                        </tr>
                    `;
                });

                container.innerHTML = `
                    <div class="table-container fade-in">
                        <table class="mobile-table" id="workTable">
                            <thead>
                                <tr>
                                    <th>Item No.</th>
                                    <th>Work Description</th>
                                    <th>Achieved</th>
                                    <th>Income (Birr)</th>
                                </tr>
                            </thead>
                            <tbody id="table-body">
                                ${tableRows}
                            </tbody>
                        </table>
                    </div>
                `;
            }

            // ---------- SOS TAB WITH HORIZONTAL BAR CHART ----------
            function loadSosTab() {
                const container = document.getElementById('contentContainer');
                
                const maxExecuted = Math.max(...sosData.map(d => d.executed));
                const maxCost = Math.max(...sosData.map(d => d.cost));
                
                container.innerHTML = `
                    <div class="sos-dashboard fade-in">
                        <div class="sos-header">
                            <h2><span>‚ö†Ô∏è</span> SOS Report</h2>
                            <p>Cost Overview</p>
                            <p>Total Plan Birr = 123,569,87456</p>
                        </div>
                        
                        <!-- Horizontal Bar Chart for SOS Data -->
                        <div class="chart-container">
                            <div class="chart-title">
                                <span>üìä</span> Executed vs Cost Comparison
                            </div>
                            <div class="bar-chart">
                                ${sosData.map((item, index) => {
                                    const executedPercent = (item.executed / maxExecuted) * 100;
                                    const costPercent = (item.cost / maxCost) * 100;
                                    return `
                                        <div class="bar-item">
                                            <div class="bar-label">
                                                <span>Period ${index + 1}: ${item.period}</span>
                                                <span>${formatCurrency(item.executed)} / ${formatCurrency(item.cost)}</span>
                                            </div>
                                            <div style="display: flex; gap: 10px; align-items: center;">
                                                <div style="flex: 1;">
                                                    <div style="font-size: 11px; color: #27ae60; margin-bottom: 2px;">Executed</div>
                                                    <div class="bar-bg">
                                                        <div class="bar-fill" style="width: ${executedPercent}%; background: linear-gradient(90deg, #27ae60, #2ecc71);">
                                                            ${executedPercent > 15 ? Math.round(executedPercent) + '%' : ''}
                                                        </div>
                                                    </div>
                                                </div>
                                                <div style="flex: 1;">
                                                    <div style="font-size: 11px; color: #e74c3c; margin-bottom: 2px;">Cost</div>
                                                    <div class="bar-bg">
                                                        <div class="bar-fill" style="width: ${costPercent}%; background: linear-gradient(90deg, #e74c3c, #c0392b);">
                                                            ${costPercent > 15 ? Math.round(costPercent) + '%' : ''}
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    `;
                                }).join('')}
                            </div>
                        </div>
                        
                        <div class="sos-table-container">
                            <table class="sos-data-table">
                                <thead>
                                    <tr>
                                        <th>Period</th>                                        
                                        <th>Executed (Birr)</th>
                                        <th>Cost (Birr)</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    ${sosData.map(item => `
                                        <tr>
                                            <td><strong>${item.period}</strong></td>                                           
                                            <td class="text-success">${formatCurrency(item.executed)}</td>
                                            <td class="text-danger">${formatCurrency(item.cost)}</td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                    </div>
                `;
            }

            // ---------- COMPARISON TAB WITH 2D COLUMN BAR CHART ----------
            function loadComparisonTab() {
                const container = document.getElementById('contentContainer');
                const d = comparisonCostData;

                // Create array of used-only items for column chart
                const usedItems = [
                    { name: 'Labour', value: d.labour.used, icon: 'üë∑' },
                    { name: 'Admin', value: d.admin, icon: 'üèõÔ∏è' },
                    { name: 'Staff', value: d.staff, icon: 'üë•' },
                    { name: 'Material', value: d.material.used, icon: 'üß±' },
                    { name: 'Machinery', value: d.machinery.used, icon: 'üöú' },
                    { name: 'Overhead', value: d.overhead, icon: 'üìä' }
                ];

                // Find maximum value for scaling column heights (max height 200px)
                const maxValue = Math.max(...usedItems.map(item => item.value));
                const maxHeight = 200; // pixels

                container.innerHTML = `
                    <div class="comparison-dashboard fade-in">
                        <div class="comparison-header">
                            <h2><span>üìä</span> Cost Overview</h2>
                            <p>2D Column Chart ‚Ä¢ Used Quantity Only</p>
                        </div>

                        <!-- 2D Column Bar Chart - Used Quantity Only -->
                        <div class="column-chart-container">
                            <div class="chart-title">
                                <span>üìä</span> Resource Usage (Birr) - 2D Columns
                            </div>
                            <div style="position: relative;">
                                <div class="column-chart">
                                    ${usedItems.map(item => {
                                        const columnHeight = (item.value / maxValue) * maxHeight;
                                        return `
                                            <div class="chart-column-wrapper">
                                                <div class="column-bar" style="height: ${columnHeight}px;">
                                                    <div class="column-value" style="position: absolute; top: -20px; left: 50%; transform: translateX(-50%);">
                                                        ${formatCompactCurrency(item.value)}
                                                    </div>
                                                </div>
                                                <div class="column-label">
                                                    ${item.icon} ${item.name}
                                                </div>
                                            </div>
                                        `;
                                    }).join('')}
                                </div>
                                <div style="display: flex; justify-content: space-between; margin-top: 5px; padding: 0 10px; font-size: 10px; color: #95a5a6;">
                                    <span>0</span>
                                    <span>${formatCompactCurrency(maxValue * 0.25)}</span>
                                    <span>${formatCompactCurrency(maxValue * 0.5)}</span>
                                    <span>${formatCompactCurrency(maxValue * 0.75)}</span>
                                    <span>${formatCompactCurrency(maxValue)}</span>
                                </div>
                            </div>
                        </div>

                        <!-- Cost Table -->
                        <table class="cost-table">
                            <thead>
                                <tr>
                                    <th>Category</th>
                                    <th>Used (Birr)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>üë∑ Labour</strong></td>
                                    <td class="text-danger">${formatCurrency(d.labour.used)}</td>
                                </tr>
                                <tr>
                                    <td><strong>üèõÔ∏è Admin</strong></td>
                                    <td>${formatCurrency(d.admin)}</td>
                                </tr>
                                <tr>
                                    <td><strong>üë• Staff</strong></td>
                                    <td>${formatCurrency(d.staff)}</td>
                                </tr>
                                <tr>
                                    <td><strong>üß± Material</strong></td>
                                    <td class="text-success">${formatCurrency(d.material.used)}</td>
                                </tr>
                                <tr>
                                    <td><strong>üöú Machinery</strong></td>
                                    <td class="text-danger">${formatCurrency(d.machinery.used)}</td>
                                </tr>
                                <tr>
                                    <td><strong>üìä Overhead (20%)</strong></td>
                                    <td>${formatCurrency(d.overhead)}</td>
                                </tr>
                                <tr class="total-row">
                                    <td><strong>TOTAL USED</strong></td>
                                    <td>${formatCurrency(d.totalUsed)}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                `;
            }

            // ---------- Tab Switching ----------
            function switchTab(tab) {
                document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
                document.querySelector(`.nav-btn[data-tab="${tab}"]`).classList.add('active');

                if (tab === 'monthly') loadMonthlyTable();
                else if (tab === 'sos') loadSosTab();
                else if (tab === 'comparison') loadComparisonTab();
            }

            // Event listeners
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    switchTab(e.currentTarget.dataset.tab);
                });
            });

            // Initialize with Monthly tab active
            document.addEventListener('DOMContentLoaded', () => {
                loadMonthlyTable();
            });
        })();
    </script>
</body>
</html>