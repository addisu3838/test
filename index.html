<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="format-detection" content="telephone=no">
    <title>Project Management</title>
    <style>
        /* Reset and Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            -webkit-text-size-adjust: 100%;
        }

        :root {
            --primary: #2c3e50;
            --secondary: #27ae60;
            --danger: #e74c3c;
            --warning: #5e574c;
            --info: #3498db;
            --bg: #2de2a6;
            --text: #333;
            --white: #ffffff;
            --light-gray: #f8f9fa;
            --border: #eee;
            --income-color: #27ae60;
            --cost-color: #e74c3c;
            --profit-color: #3498db;
            --header-gradient: linear-gradient(135deg, rgba(44, 62, 80, 0.9), rgba(52, 73, 94, 0.9));
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            color: var(--text);
            background: var(--bg);
            line-height: 1.4;
            padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
            min-height: 100vh;
            overflow-x: hidden;
            background-color: #e74c3c;
        }

        /* Main Container */
        .app-wrapper {
            width: 100%;
            min-height: 100vh;
            background: rgb(231, 170, 170);
            display: flex;
            flex-direction: column;
        }

        /* Content Container */
        .content-container {
            flex: 1;
            overflow-x: hidden;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            background-color: #dde6e1;
        }

        /* Mobile-friendly Table */
        .table-container {
            width: 100%;
        }

        .mobile-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
        }

        .mobile-table th {
            background: var(--header-gradient);
            color: rgb(226, 139, 139);
            padding: 16px 10px;
            text-align: left;
            font-weight: 600;
            font-size: 12px;
            letter-spacing: 0.3px;
            white-space: nowrap;
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 1px solid rgba(73, 108, 223, 0.2);
            box-shadow: 0 1px 4px rgba(0,0,0,0.1);
            background-color: #ac2424;
        }

        .mobile-table th:first-child {
            border-left: none;
        }

        .mobile-table th:last-child {
            border-right: none;
        }

        .mobile-table td {
            padding: 8px 7px;
            border-bottom: 1px solid #eee;
            vertical-align: top;
        }

        .mobile-table tr:last-child td {
            border-bottom: none;
        }

        .mobile-table tr:nth-child(even) {
            background: #fafafa;
        }

        .mobile-table tr:hover {
            background: #f0f7ff;
        }

        /* Column widths for mobile */
        .mobile-table th:nth-child(1), 
        .mobile-table td:nth-child(1) { 
            width: 1%; 
            min-width: 20px; 
            max-width: 60px;
        }
        .mobile-table th:nth-child(2), 
        .mobile-table td:nth-child(2) { 
            width: 11%; 
            min-width: 10px;
            max-width: 50;
            max-height: 8px;
            min-height: 1;
        }
        .mobile-table th:nth-child(3), 
        .mobile-table td:nth-child(3) { 
            width: 4%; 
            min-width: 10px;
            max-width: 20px;
        }
        .mobile-table th:nth-child(4), 
        .mobile-table td:nth-child(4) 
        { 
            width: 5%; 
            min-width: 10px;
            max-width: 20;
        }
        .mobile-table th:nth-child(5), 
        .mobile-table td:nth-child(5) { 
            width: 20%;
            min-width: 90px;
            display: none;
        }

        .cost-column th:nth-child(5),
        .cost-column td:nth-child(5) {
            display: table-cell !important;
        }

        /* Adjust other column widths when cost column is shown */
        .cost-column th:nth-child(2),
        .cost-column td:nth-child(2) {
            width: 25%;
        }
        
        .cost-column th:nth-child(4),
        .cost-column td:nth-child(4) {
            width: 25%;
        }

        /* Table cell content */
        .item-no {
            font-weight: 700;
            color: var(--primary);
            font-size: 11px;

        }

        .work-description {
            font-size: 12px;
            line-height: 1.5;
            color: #444;
            max-height: 40px;
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 4;
            -webkit-box-orient: vertical;
            max-width: 800px;
        }

        .achievement-cell {
            font-weight: 400;
            color: var(--primary);
            text-align: right;
            font-size: 11px;
            white-space: nowrap;
            font-style: italic;
        }

        .income-value {
            color: var(--income-color);
            font-weight: 700;
            font-size: 12px;
            text-align: right;
            white-space: nowrap;
        }

        .cost-value {
            color: var(--cost-color);
            font-weight: 700;
            font-size: 12px;
            text-align: right;
            white-space: nowrap;
        }

        /* Footer Tabs */
        .excel-footer {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            padding: 10px 12px;
            position: sticky;
            bottom: 0;
            z-index: 1000;
            border-top: 6px solid rgba(230, 106, 106, 0.1);
        }

        .tabs-container {
            display: flex;
            overflow-x: auto;
            gap: 0px;
            padding-bottom: 2px;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
        }

        .tabs-container::-webkit-scrollbar {
            display: none;
        }

        .nav-btn {
            flex: 0 0 auto;
            background: rgba(255, 255, 255, 0.15);
            color: rgb(136, 91, 91);
            border: none;
            padding: 10px 14px;
            border-radius: 10px;
            font-size: 13px;
            font-weight: 600;
            white-space: nowrap;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 6px;
            min-width: 85px;
            justify-content: center;
        }

        .nav-btn:active {
            transform: scale(0.96);
            background: rgba(255, 255, 255, 0.25);
        }

        .nav-btn.active {
            background: var(--info);
            color: white;
            box-shadow: 0 2px 8px rgba(52, 152, 219, 0.3);
        }

        /* Payroll Styles */
        .payroll-container {
            background: rgb(203, 224, 169);
            width: 100%;
            min-height: 100%;
        }

        .payroll-header {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: rgb(189, 221, 183);
            padding: 16px 12px;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .payroll-header h3 {
            font-size: 1px;
            font-weight: 700;
            margin-bottom: 4px;
        }

        .payroll-header p {
            font-size: 12px;
            opacity: 0.9;
        }

        .payroll-tabs {
            display: flex;
            overflow-x: auto;
            background: #f5f5f5;
            padding: 8px;
            gap: 6px;
            scrollbar-width: none;
            position: sticky;
            top: 74px; /* Height of payroll header */
            z-index: 99;
            -webkit-overflow-scrolling: touch;
        }

        .payroll-tabs::-webkit-scrollbar {
            display: none;
        }

        .payroll-tab {
            flex: 0 0 auto;
            background: white;
            border: 2px solid transparent;
            padding: 10px 16px;
            border-radius: 10px;
            font-size: 13px;
            font-weight: 600;
            color: #070404;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.2s ease;
        }

        .payroll-tab:active {
            transform: scale(0.96);
        }

        .payroll-tab.active {
            background: var(--info);
            color: white;
            border-color: var(--info);
            box-shadow: 0 2px 6px rgba(52, 152, 219, 0.2);
        }

        .payroll-content {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        .payroll-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 12px;
            min-width: 500px;
        }

        .payroll-table th {
            background: #ccf8ba;
            color: rgb(4, 7, 17);
            padding: 12px 8px;
            text-align:center;
            font-weight: 600;
            font-size: 14px;
            position: sticky;
            top: 11px; /* Height of payroll header + tabs */
            z-index: 98;
        }

        .payroll-table td {
            padding: 10px 8px;
            border-bottom: 1px solid #eee;
            text-align: center;
        }

        .payroll-table tr:nth-child(even) {
            background: #fafafa;
        }

        .payroll-total-row {
            background: #2c3e50 !important;
            color: white;
            font-weight: 700;
        }

        /* Coming Soon Message */
        .coming-soon {
            background: rgb(196, 252, 144);
            border-radius: 12px;
            padding: 40px 24px;
            text-align: center;
            margin: 12px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.05);
        }

        .coming-soon-icon {
            font-size: 28px;
            margin-bottom: 16px;
        }

        .coming-soon h3 {
            font-size: 18px;
            color: var(--primary);
            margin-bottom: 8px;
            font-weight: 700;
        }

        .coming-soon p {
            color: #ca5454;
            font-size: 14px;
            line-height: 1.5;
        }

        /* Scrollbar Styling */
        ::-webkit-scrollbar {
            width: 4px;
            height: 4px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 10px;
        }

        /* Responsive adjustments */
        @media (max-width: 360px) {
            .mobile-table {
                font-size: 12px;
            }
            
            .mobile-table th,
            .mobile-table td {
                padding: 12px 8px;
            }
            
            .mobile-table th:nth-child(1), 
            .mobile-table td:nth-child(1) { 
                min-width: 60px; 
                max-width: 70px;
            }
            
            .nav-btn {
                min-width: 75px;
                padding: 8px 12px;
                font-size: 12px;
            }
            
            .payroll-tab {
                padding: 8px 12px;
                font-size: 12px;
            }
        }

        /* Safe area support */
        @supports (padding: max(0px)) {
            body {
                padding-left: max(0px, env(safe-area-inset-left));
                padding-right: max(0px, env(safe-area-inset-right));
                padding-top: max(0px, env(safe-area-inset-top));
                padding-bottom: max(0px, env(safe-area-inset-bottom));
            }
            
            .excel-footer {
                padding-bottom: max(10px, env(safe-area-inset-bottom));
            }
        }

        /* Animation */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in {
            animation: fadeIn 0.3s ease-out;
        }
    </style>
</head>
<body>
    <div class="app-wrapper">
        <div class="content-container" id="contentContainer">
            <!-- Content will be dynamically loaded here -->
        </div>
        
        <div class="excel-footer">
            <div class="tabs-container">
                <button class="nav-btn active" onclick="switchTab('monthly')">
                    <span>üìÖ</span> Income
                </button>
                <button class="nav-btn" onclick="switchTab('sos')">
                    <span>‚ö†Ô∏è</span> SOS
                </button>
                <button class="nav-btn" onclick="switchTab('comparison')">
                    <span>üìä</span> Comparison
                </button>
                <button class="nav-btn" onclick="switchTab('payroll')">
                    <span>üí∞</span> Payroll
                </button>
                <button class="nav-btn" onclick="switchTab('Chart')">
                    <span>üíµ</span> Chart
                </button>
                <button class="nav-btn" onclick="switchTab('cost-analysis')">
                    <span>üìâ</span> Cost Analysis
                </button>
            </div>
        </div>
    </div>

    <script>
        // ==================== TELEGRAM MINI APP INITIALIZATION ====================
        // Check if Telegram WebApp is available
        if (window.Telegram && window.Telegram.WebApp) {
            const tg = Telegram.WebApp;
            
            // Expand the app to full height
            tg.expand();
            
            // Set background color
            tg.setBackgroundColor('#f4f7f6');
            
            // Set header color
            tg.setHeaderColor('#2c3e50');
            
            // Enable closing confirmation
            tg.enableClosingConfirmation();
            
            // Initialize the app
            tg.ready();
        }

        // ==================== APPLICATION DATA AND LOGIC ====================
        // Sample data for the construction project with income and cost
        const projectData = [
            { 
                itemNo: "1.12.8", 
                description: "Allow for supplying temporary electricity, water, telephone and other utility bills for the supervisor's and contractor's including connection, distribution system for the work, internal arrangements and all payment to the authorities for connections. it is the responsibility of the contractor to ensure steady and uninterrupted power supply to work", 
                achievement: 0.72,                 
                total: "9141575.07295305", 
                cost: "100000"
            },
            { 
                itemNo: "1.13.3", 
                description: "Provisions of security", 
                achievement: 0.72,               
                total: "1425815.46702017", 
                cost: "280000"
            },
            { 
                itemNo: "1.12", 
                description: "Allow for expenses required for conducting compensation payment estimation such as periderm for Committee, fuel cost, printing expenses and other related expenses. Payment shall be paid up on approval of the Engineer keeping all legal procedures. The costs will be reimbursed to the contractor after receiving the original invoice in the payment certificate by the Consultant", 
                achievement: 0.12,                
                total: "425000", 
                cost: "350000"
            },
            { 
                itemNo: "3.A.1", 
                description: "Mobilization and Demoblization", 
                achievement: 0.5,              
                total: "292789.65", 
                cost: "168000"
            },
            { 
                itemNo: "2.3.1", 
                description: "Fill and compaction the Core zone with clay material with max hauling distance of 5 Km", 
                achievement: 29479.5,               
                total: "8533136.07", 
                cost: "121000"
            },
            { 
                itemNo: "2.4.1", 
                description: "Fill and compaction the Shell zone with selected material, max hauling distance of 5 Km", 
                achievement: 43277.3,                
                total: "11292778.662", 
                cost: "72000"
            },
            { 
                itemNo: "2.5.1", 
                description: "Filter material (Finer) supply and fill(zone 2A)", 
                achievement: 6643.13,                
                total: "8189650.664", 
                cost: "96000"
            },
            { 
                itemNo: "2.5.2", 
                description: "Filter material (coarser) supply and fill(zone 2B)", 
                achievement: 3020,                
                total: "3729851", 
                cost: "36000"
            },
            { 
                itemNo: "2.5.4", 
                description: "Riprap(zone 5)", 
                achievement: 2329.54,               
                total: "1890631.3686", 
                cost: "14400"
            },
            { 
                itemNo: "2.6.1", 
                description: "Fill and compaction zone 4 with Rock material", 
                achievement: 48677.76,            
                total: "41367334.0032", 
                cost: "3600"
            },
            
            { 
                itemNo: "", 
                description: "production of rock", 
                achievement: 53248,                 
                total: "", 
                cost: ""
                
            },
            { 
                itemNo: "2.9.4", 
                description: "Vibrating Wire Piezometer with its complete accessories in embankment", 
                achievement: 3,               
                total: "561600", 
                cost: "3600"
            },
            { 
                itemNo: "2.9.5", 
                description: "Vibrating Wire settlement sensor with complete accessories", 
                achievement: 2,                
                total: "41367334.0032", 
                cost: "3600"
            },
            { 
                itemNo: "2.9.8", 
                description: "Vibrating wire cable", 
                achievement: 307.94,                
                total: "288231.84", 
                cost: "3600"
            },
            { 
                itemNo: "4.2.4", 
                description: "Base slab", 
                achievement: 3.17,               
                total: "16324.64064", 
                cost: "3600"
            },
            { 
                itemNo: "8.5.1", 
                description: "C-25 concrete work including formwork", 
                achievement: 8.5,                
                total: "45602.5", 
                cost: "3600"
            },
            { 
                itemNo: "8.5.3", 
                description: "Reinforcement bars (bending, cutting & placing)", 
                achievement: 48677.76,                 
                total: "19046.358", 
                cost: "3600"
            },
            { 
                itemNo: "11.7.1", 
                description: "Ordinary soil excavation", 
                achievement: 156.6,                 
                total: "12935.16", 
                cost: "3600"
            },                        
            { 
                itemNo: "11.7.2", 
                description: "Basaltic or equivalent stone masonry work in cement sand mortar of 1:3 mix ratio", 
                achievement: 404.811,                
                total: "932097.56805", 
                cost: "3600"
            },                         
            { 
                itemNo: "11.7.3", 
                description: "C-25 concrete mixing, placing, vibrating and curing for slab including formwork", 
                achievement: 32.8,                
                total: "194254.72", 
                cost: "3600"
            },                         
            { 
                itemNo: "11.7.4", 
                description: "Reinforcement bars of √∏10mm as specified on the drawings with 150mm spacing", 
                achievement: 156.6,                 
                total: "103,830.33", 
                cost: "3,600"
            },                         
            { 
                itemNo: "New", 
                description: "Reinforcement bar of Dia 12mm as specified on the drawing with 200mm spacing", 
                achievement: 3663.2,                
                total: "250,343.088", 
                cost: "3,600"
            },                         
            { 
                itemNo: "11.7.6", 
                description: "Cart away excavated material", 
                achievement: 96,               
                total: "4,304.64", 
                cost: "3,600"
            },
            { 
                itemNo: "11.7.8", 
                description: "Back fill with shell material around the ditch", 
                achievement: 480,                 
                total: "4,304.64", 
                cost: "3,600"
            }
        ];

        // Variables to track current view
        let isCostViewVisible = false;
        let currentTab = 'monthly';

        // Function to format currency
        function formatCurrency(amount) {
            if (isNaN(amount)) return "0.00";
            if (amount >= 1) {
                return (amount / 1).toFixed(2) + '';
            } else if (amount >= 1) {
                return (amount / 1).toFixed(2) + '';
            }
            return amount.toLocaleString('en-US', {
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            });
        }

        // Function to format achievement number
        function formatAchievement(value) {
            if (isNaN(value)) return "0";
            if (value >= 1) {
                return (value / 1).toFixed(1) + '';
            }
            if (value % 1 === 0) {
                return value.toString();
            } else {
                return value.toFixed(2);
            }
        }

        // Function to load main table (monthly tab)
        function loadMonthlyTable() {
            const contentContainer = document.getElementById("contentContainer");
            
            contentContainer.innerHTML = `
                <div class="table-container fade-in">
                    <table class="mobile-table ${isCostViewVisible ? 'cost-column' : ''}" id="workTable">
                        <thead>
                            <tr>
                                <th>Item No.</th>
                                <th>Work Description</th>
                                <th>Achievement</th>
                                <th>Income (Birr)</th>
                                <th>Cost (Birr)</th>
                            </tr>
                        </thead>
                        <tbody id="table-body">
                            <!-- Data will be inserted here -->
                        </tbody>
                    </table>
                </div>
            `;
            
            // Load the table data
            const tableBody = document.getElementById("table-body");
            tableBody.innerHTML = '';
            
            projectData.forEach(item => {
                const row = document.createElement("tr");
                
                const incomeValue = parseFloat(item.total.replace(/,/g, ''));
                const costValue = parseFloat(item.cost);
                
                row.innerHTML = `
                    <td><div class="item-no">${item.itemNo}</div></td>
                    <td><div class="work-description" title="${item.description}">${item.description}</div></td>
                    <td><div class="achievement-cell">${formatAchievement(item.achievement)}</div></td>
                    <td><div class="income-value">${formatCurrency(incomeValue)}</div></td>
                    <td><div class="cost-value">${formatCurrency(costValue)}</div></td>
                `;
                tableBody.appendChild(row);
            });
        }

        // Function to toggle cost view - now using keyboard shortcut only
        function toggleCostView() {
            isCostViewVisible = !isCostViewVisible;
            
            const table = document.getElementById('workTable');
            if (table) {
                if (isCostViewVisible) {
                    table.classList.add('cost-column');
                } else {
                    table.classList.remove('cost-column');
                }
            }
        }

        // Function to load payroll tab
        function loadPayrollTab() {
            const contentContainer = document.getElementById("contentContainer");
            
            contentContainer.innerHTML = `
                <div class="payroll-container fade-in">
                    <div class="payroll-header">
                        <h3>üë∑ ·ã®·à∞·à´·â∞·äû·âΩ ·àò·ãù·åà·â•</h3>
                        <p>30 ·âÄ·äì·âµ ·ã®·à•·à´ ·àõ·àµ·ä¨·åÉ ·àò·ãù·åà·â•</p>
                    </div>
                    
                    <div class="payroll-tabs" id="payrollTabsContainer">
                        <!-- Tabs will be generated here -->
                    </div>
                    
                    <div class="payroll-content" id="payrollSheetContent">
                        <div style="text-align: center; padding: 20px; color: #666;">
                            ·àò·à®·åÉ ·â†·àò·å´·äï ·àã·ã≠...
                        </div>
                    </div>
                </div>
            `;
            
            // Initialize payroll
            initPayroll();
        }

        // Function to show coming soon message
        function showComingSoon(tabName) {
            const contentContainer = document.getElementById("contentContainer");
            
            const tabIcons = {
                'sos': '‚ö†Ô∏è',
                'comparison': 'üìä',
                'income': 'üíµ',
                'cost-analysis': 'üìâ'
            };
            
            const tabTitles = {
                'sos': 'SOS Report',
                'comparison': 'Comparison View',
                'income': 'Income Report',
                'cost-analysis': 'Cost Analysis'
            };
            
            const icon = tabIcons[tabName] || 'üöß';
            const title = tabTitles[tabName] || 'Feature';
            
            contentContainer.innerHTML = `
                <div class="coming-soon fade-in">
                    <div class="coming-soon-icon">${icon}</div>
                    <h3>${title}</h3>
                    <p>
                        This feature is currently under development.<br>
                        We're working hard to bring you this functionality soon.
                    </p>
                </div>
            `;
        }

        // Function to switch between tabs
        function switchTab(tabName) {
            currentTab = tabName;
            
            // Remove active class from all buttons
            const buttons = document.querySelectorAll('.nav-btn');
            buttons.forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Add active class to clicked button
            const activeBtn = document.querySelector(`.nav-btn[onclick*="${tabName}"]`);
            if (activeBtn) {
                activeBtn.classList.add('active');
            }
            
            // Show the selected content
            if (tabName === 'monthly') {
                loadMonthlyTable();
            } else if (tabName === 'payroll') {
                loadPayrollTab();
            } else {
                showComingSoon(tabName);
            }
        }

        // ==================== PAYROLL FUNCTIONS ====================
        const sheetsData = [
            { name: "·â∞·àµ·çã·ãâ", rows: generateTesfawuData() },
            { name: "·ã≥·â†·à®", rows: generateDabereData() },
            { name: "·å•·â†·â†", rows: generateTibebeData() },
            { name: "·â•·à©·ä≠", rows: generateBrukData() },
            { name: "·ä†·ã´·àà·ãâ", rows: generateAyalewuData() },
            { name: "·ãò·ä´·à≠·ã´·àµ", rows: generateZekariyasData() },
            { name: "·àö·ä´·ä§·àç", rows: generateMikaealData() }
        ];

        function generateTesfawuData() {
            const columns = ["·âÄ·äï", "Guard", "Dl", "Time Keeper", "Carpenter", "Mason", "Barbender"];
            const data = [columns];
            data.push(["26", "3", "", "1", "", "", ""]);
            data.push(["27", "3", "", "1", "", "", ""]);
            data.push(["28", "", "", "", "", "", ""]);
            data.push(["29", "6", "", "1", "", "", ""]);
            data.push(["30", "3", "", "1", "", "", ""]);
            for (let i = 1; i <= 25; i++) {
                let guard = "";
                let timeKeeper = Math.random() > 0.2 ? "1" : "";
                if (i % 7 === 0) {
                    guard = Math.random() > 0.3 ? "6" : "3";
                } else {
                    guard = Math.random() > 0.2 ? "3" : "";
                }
                data.push([i.toString(), guard, "", timeKeeper, "", "", ""]);
            }
            return data;
        }

        function generateDabereData() {
            const columns = ["·âÄ·äï", "Guard", "Dl", "Time Keeper", "Carpenter", "Mason", "Barbender"];
            const data = [columns];
            data.push(["26", "11", "1", "", "", "", ""]);
            data.push(["27", "11", "1", "", "", "", ""]);
            data.push(["28", "11", "", "", "", "", ""]);
            data.push(["29", "11", "1", "", "", "", ""]);
            data.push(["30", "11", "1", "", "", "", ""]);
            for (let i = 1; i <= 25; i++) {
                let guard = "";
                let dl = "";
                if (i % 7 === 0) {
                    guard = Math.random() > 0.3 ? "22" : "11";
                } else {
                    guard = Math.random() > 0.2 ? "11" : "";
                }
                if (guard && Math.random() > 0.4) {
                    dl = Math.floor(Math.random() * 3 + 1).toString();
                }
                data.push([i.toString(), guard, dl, "", "", "", ""]);
            }
            return data;
        }

        function generateTibebeData() {
            const columns = ["·âÄ·äï", "Guard", "Dl", "Time Keeper", "Carpenter", "Mason", "Barbender"];
            const data = [columns];
            data.push(["26", "", "9.5", "", "", "", ""]);
            data.push(["27", "", "9", "", "", "", ""]);
            data.push(["28", "", "4", "", "", "", ""]);
            data.push(["29", "", "9", "", "", "", ""]);
            data.push(["30", "", "8.5", "", "", "", ""]);
            for (let i = 1; i <= 25; i++) {
                let dl = (Math.random() * 10 + 1).toFixed(1);
                let carpenter = Math.random() > 0.8 ? "0.5" : "";
                data.push([i.toString(), "", dl, "", carpenter, "", ""]);
            }
            return data;
        }

        function generateBrukData() {
            const columns = ["·âÄ·äï", "Guard", "Dl", "Time Keeper", "Carpenter", "Mason", "Barbender"];
            const data = [columns];
            data.push(["26", "", "2", "", "1", "", ""]);
            data.push(["27", "8", "3", "", "1", "", ""]);
            data.push(["28", "", "", "", "", "", ""]);
            data.push(["29", "4", "3", "", "1", "", ""]);
            data.push(["30", "4", "2", "", "1", "", ""]);
            for (let i = 1; i <= 25; i++) {
                let carpenter = Math.random() > 0.6 ? "1" : "";
                let guard = "";
                let dl = "";
                if (carpenter) {
                    guard = Math.random() > 0.5 ? (Math.random() > 0.5 ? "8" : "4") : "";
                    dl = Math.random() > 0.4 ? Math.floor(Math.random() * 4 + 1).toString() : "";
                }
                data.push([i.toString(), guard, dl, "", carpenter, "", ""]);
            }
            return data;
        }

        function generateAyalewuData() {
            const columns = ["·âÄ·äï", "Guard", "Dl", "Time Keeper", "Carpenter", "Mason", "Barbender"];
            const data = [columns];
            data.push(["26", "2", "", "1", "", "", ""]);
            data.push(["27", "2", "", "1", "", "", ""]);
            data.push(["28", "", "", "", "", "", ""]);
            data.push(["29", "4", "", "1", "", "", ""]);
            data.push(["30", "4", "", "2", "", "", ""]);
            for (let i = 1; i <= 25; i++) {
                let timeKeeper = Math.random() > 0.3 ? "1" : "";
                let guard = "";
                if (timeKeeper) {
                    guard = Math.random() > 0.5 ? 
                        (Math.random() > 0.7 ? "10" : 
                         Math.random() > 0.5 ? "5" : "2") : "";
                }
                data.push([i.toString(), guard, "", timeKeeper, "", "", ""]);
            }
            return data;
        }

        function generateZekariyasData() {
            const columns = ["·âÄ·äï", "Guard", "Dl", "Time Keeper", "Carpenter", "Mason", "Barbender"];
            const data = [columns];
            data.push(["26", "", "", "1", "", "", ""]);
            data.push(["27", "", "", "1", "", "", ""]);
            data.push(["28", "", "", "", "", "", ""]);
            data.push(["29", "", "", "1", "", "", ""]);
            data.push(["30", "", "", "2", "", "", ""]);
            for (let i = 1; i <= 25; i++) {
                let timeKeeper = Math.random() > 0.4 ? "1" : "";
                let dl = "";
                if (timeKeeper && Math.random() > 0.5) {
                    dl = (Math.random() * 10 + 1).toFixed(1);
                }
                data.push([i.toString(), "", dl, timeKeeper, "", "", ""]);
            }
            return data;
        }

        function generateMikaealData() {
            const columns = ["·âÄ·äï", "Guard", "Dl", "Time Keeper", "Carpenter", "Mason", "Barbender"];
            const data = [columns];
            data.push(["26", "", "24", "", "", "", ""]);
            data.push(["27", "", "23", "", "", "", ""]);
            data.push(["28", "", "", "", "", "", ""]);
            data.push(["29", "", "31", "", "", "", ""]);
            data.push(["30", "", "31", "", "", "", ""]);
            for (let i = 1; i <= 25; i++) {
                let dl = (Math.random() * 30 + 15).toFixed(1);
                data.push([i.toString(), "", dl, "", "", "", ""]);
            }
            return data;
        }

        function initPayroll() {
            const tabsContainer = document.getElementById('payrollTabsContainer');
            const sheetContent = document.getElementById('payrollSheetContent');

            // Clear any existing tabs
            tabsContainer.innerHTML = '';

            // Create only 7 tabs
            sheetsData.forEach((sheet, index) => {
                const button = document.createElement('button');
                button.className = 'payroll-tab';
                button.textContent = sheet.name;
                button.addEventListener('click', () => showPayrollSheet(index));
                tabsContainer.appendChild(button);
            });

            // Show first sheet
            if (sheetsData.length > 0) {
                showPayrollSheet(0);
                document.querySelector('.payroll-tab').classList.add('active');
            }
        }

        function calculatePayrollColumnSums(rows) {
            if (rows.length < 2) return [];
            const sums = new Array(rows[0].length).fill(0);
            const hasNumericData = new Array(rows[0].length).fill(false);
            for (let i = 1; i < rows.length; i++) {
                const row = rows[i];
                for (let j = 0; j < row.length; j++) {
                    const cell = row[j];
                    const num = parseFloat(cell);
                    if (!isNaN(num) && cell !== '' && cell !== ' ') {
                        sums[j] += num;
                        hasNumericData[j] = true;
                    }
                }
            }
            return sums.map((sum, index) => ({
                sum: sum,
                hasData: hasNumericData[index],
                columnName: rows[0][index] || `·ä†·àù·ãµ ${index}`
            }));
        }

        function showPayrollSheet(index) {
            const sheet = sheetsData[index];
            const sheetContent = document.getElementById('payrollSheetContent');
            const columnSums = calculatePayrollColumnSums(sheet.rows);

            sheetContent.innerHTML = '';

            const table = document.createElement('table');
            table.className = 'payroll-table';
            
            // Header
            const thead = document.createElement('thead');
            const headerRow = document.createElement('tr');
            sheet.rows[0].forEach(cell => {
                const th = document.createElement('th');
                th.textContent = cell;
                headerRow.appendChild(th);
            });
            thead.appendChild(headerRow);
            table.appendChild(thead);
            
            // Body
            const tbody = document.createElement('tbody');
            for (let i = 1; i < sheet.rows.length; i++) {
                const row = document.createElement('tr');
                
                sheet.rows[i].forEach((cell, cellIndex) => {
                    const td = document.createElement('td');
                    if (cell === '') {
                        td.textContent = '-';
                        td.style.color = '#bbb';
                    } else {
                        td.textContent = cell;
                        if (cellIndex === 0) {
                            td.style.fontWeight = '600';
                            td.style.color = '#3498db';
                        } else if (!isNaN(parseFloat(cell))) {
                            td.style.fontWeight = '600';
                        }
                    }
                    row.appendChild(td);
                });
                tbody.appendChild(row);
            }
            
            // Total row
            const totalRow = document.createElement('tr');
            totalRow.className = 'payroll-total-row';
            columnSums.forEach((col, colIndex) => {
                const td = document.createElement('td');
                if (colIndex === 0) {
                    td.textContent = '·å†·âÖ·àã·àã';
                } else if (col.hasData) {
                    td.textContent = col.sum.toFixed(2);
                } else {
                    td.textContent = '-';
                }
                totalRow.appendChild(td);
            });
            tbody.appendChild(totalRow);
            
            table.appendChild(tbody);
            sheetContent.appendChild(table);

            // Update active tab
            document.querySelectorAll('.payroll-tab').forEach((btn, i) => {
                btn.classList.toggle('active', i === index);
            });
        }

        // ==================== INITIALIZATION ====================
        // Initialize the application when the page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Load monthly table by default
            loadMonthlyTable();
            
            // Add keyboard shortcut for cost view toggle (Ctrl+C)
            document.addEventListener('keydown', function(event) {
                // Ctrl+C to toggle cost column
                if (event.ctrlKey && event.key === 'c') {
                    event.preventDefault();
                    toggleCostView();
                }
            });
        });
    </script>
</body>
</html>